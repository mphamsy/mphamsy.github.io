<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>SVM: Sentiment Classification | Michal Pham Sy</title> <meta name="author" content="Michal Pham Sy"/> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "/> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>⚛️</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://mphamsy.github.io/projects/svm_class/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Michal </span>Pham Sy</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About Me</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Project Portfolio</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">SVM: Sentiment Classification</h1> <p class="post-description"></p> </header> <article> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/sentiment.JPG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/sentiment.JPG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/sentiment.JPG-1400.webp"></source> <img src="/assets/img/sentiment.JPG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="sentiment" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><br></p> <h3 id="requirements"><strong>Requirements</strong></h3> <p>This project is written in Python and requires the following libraries to be <strong>installed</strong> and <strong>imported</strong>.</p> <script src="https://gist.github.com/mphamsy/47122ea0b84e2266ffb809d02c64e550.js"></script> <p><br></p> <h3 id="dataset"><strong>Dataset</strong></h3> <p>The dataset chosen for this project is a fraction of the IMDB dataset containing 50k reviews for natural language processing (NLP) purposes. The dataset is devoted for binary classification tasks. Each review contains a corresponding negative or positive sentiment.</p> <ul> <li>The training dataset size: 5000</li> <li>The testing dataset size: 1500</li> </ul> <script src="https://gist.github.com/mphamsy/55895e94ee67461dffefffca1df7ba42.js"></script> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The shape of train : (5000, 2)
The shape of test : (1500, 2)
</code></pre></div></div> <p>The dataset is read and parsed with Pandas library. The sample example of the training dataset is shown in the figure below.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Sentiment: “Positive”
Review: “This little low-budget gem is thoroughly loveable and enjoyable and definitely a keeper. I give it an 11 out of 10!”
</code></pre></div></div> <p><br></p> <h3 id="pre-processing"><strong>Pre-processing</strong></h3> <p>The custom tokenizer function is created to handle the following aspects of each review.</p> <ul> <li>Make all text lower case</li> <li>Remove special punctuation and numerical values</li> <li>Remove additional characters</li> <li>Remove stop words</li> <li>Stem remaining words with a snowball stemmer.</li> </ul> <script src="https://gist.github.com/mphamsy/0f9b39a0895e7df9b0ada44132bb6f89.js"></script> <p>Consequently, the tokenizer function is used inside the vectorizer function as a tokenizer input. The data itself requires to be vectorized to be processable for the SVM classifier. The <strong>Term Frequency Inverse Document Frequency (TF-IDF)</strong> vectoriser is implemented that takes into consideration the commonality/frequency of words and weigh them accordingly.</p> <script src="https://gist.github.com/mphamsy/e196f83c65dbadea36415bb13a867f07.js"></script> <p><br></p> <h3 id="svm-classifier"><strong>SVM Classifier</strong></h3> <p>A <strong>Support Vector Machine (SVM)</strong> is a supervised Machine Learning algorithm that performs well for text classification tasks.</p> <p>The SVM algorithms attempts to find the optimum hyperplane to divide n-dimensional data. This method works well for data that can be separated linearly. However, the majority of real-world problems are nonlinear. As a result, kernels are being utilized to convert linearly inseparable problems data into a higher-dimensional space, allowing the data to be linearly separable.</p> <p>The GridSearchCV utilizing <strong>Scikit-learn</strong> library will be used to find the optimal set of hyperparameters of C and gamma for the <strong>sigmoid</strong> kernel. The kernel choice optimization has been undertaken as a part of this project, and <strong>sigmoid</strong> kernel was found to be the best out of <strong>RBH</strong> and <strong>Linear</strong> kernels.</p> <script src="https://gist.github.com/mphamsy/335110934b18db63029229f2170ed333.js"></script> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Fitting 5 folds for each of 60 candidates, totalling 300 fits
[CV 1/5] END .C=0.1, gamma=0.01, kernel=sigmoid;, score=0.507 total time=   8.1s
[CV 2/5] END .C=0.1, gamma=0.01, kernel=sigmoid;, score=0.507 total time=   8.1s
[CV 3/5] END .C=0.1, gamma=0.01, kernel=sigmoid;, score=0.505 total time=   8.1s
[CV 4/5] END .C=0.1, gamma=0.01, kernel=sigmoid;, score=0.505 total time=   8.1s
[CV 5/5] END .C=0.1, gamma=0.01, kernel=sigmoid;, score=0.505 total time=   8.1s
...
[CV 4/5] END C=100.0, gamma=1.0, kernel=sigmoid;, score=0.775 total time=   8.1s
[CV 5/5] END C=100.0, gamma=1.0, kernel=sigmoid;, score=0.800 total time=   6.4s

The best parameters for sigmoid are: {'C': 0.4, 'gamma': 1.0, 'kernel': 'sigmoid'}
</code></pre></div></div> <p>Based on the GridSearchCV finding the best hyperparameters of C and gamma are C: 0.4 and gamma: 1.0 for sigmoid kernel. The results of each hyperparameter pair of C and gamma based on the mean test score are displayed in the heatmap below.</p> <div class="row"> <div class="col-md-6 offset-md-3"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/SVMheatmap.JPG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/SVMheatmap.JPG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/SVMheatmap.JPG-1400.webp"></source> <img src="/assets/img/SVMheatmap.JPG" class="middle" width="auto" height="auto" title="Heatmap" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The hyperparameter heatmap </div> <p><br></p> <h3 id="training-the-best-sigmoid-svm"><strong>Training The Best Sigmoid SVM</strong></h3> <p>The SVM classifier is trained with the best parameters found from the GridSearchCV. The learning curves of the SVM model were recorded during the training of the best model.</p> <script src="https://gist.github.com/mphamsy/4634d9d8313d6bb3b620224dcfbf3aa9.js"></script> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The accuracy score is : 87.06%
</code></pre></div></div> <p>The <strong>accuracy score of 87.06%</strong> was achieved for the best sigmoid kernel with its learning curves being displayed below.</p> <div class="row"> <div class="col-md-5 offset-md-2"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/LearningcurvesSVM.JPG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/LearningcurvesSVM.JPG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/LearningcurvesSVM.JPG-1400.webp"></source> <img src="/assets/img/LearningcurvesSVM.JPG" class="middle" width="auto" height="auto" title="Learning Curves" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Learning Curves for the best sigmoid kernel </div> <p><br></p> <h3 id="results"><strong>Results</strong></h3> <p>The results are highly satisfactory proving that SVM sigmoid kernel is capable of classifying reviews with an exceptional accuracy score of 87.06% with a limited size of the training data. Additional, training examples along with increasing the size of vocabulary data from 2000 may prove to be beneficial for the binary classification tasks. The overall performance of the SVM classifier is displayed in the following confusion matrix.</p> <script src="https://gist.github.com/mphamsy/13187488c21b0f5e8ba15c51066fc44a.js"></script> <div class="row"> <div class="col-md-6 offset-md-3"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/CMSVM.JPG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/CMSVM.JPG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/CMSVM.JPG-1400.webp"></source> <img src="/assets/img/CMSVM.JPG" class="center" width="auto" height="auto" title="Confusion Matrix" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Confusion Matrix </div> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2022 Michal Pham Sy. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>